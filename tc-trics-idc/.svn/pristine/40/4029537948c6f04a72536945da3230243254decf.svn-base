// layui.use('table', function(){
//     var table = layui.table;
//     table.render({
//         elem: '#test'
//         ,url:'/user/getPage'
//         ,title: '用户数据表'
//         ,cols: [[
//             {type: 'checkbox'},
//             {field: 'id', title: 'ID',}
//             , {field: 'name', title: '姓名'}
//             , {field: 'username', title: '账号',}
//             , {field: 'orgName', title: '机构'}
//             , {field: 'email', title: '邮箱'}
//             , {field: 'isQuit', title: '是否离职',templet: function(d){
//                     var isQ=d.isQuit;
//                     if(isQ==0){
//                         return "在职";
//                     }else{
//                         return "离职"
//                     }
//                 }}
//             , {field: 'createTime', title: '创建时间' ,templet: function(d){
//                     var dateee = new Date(d.createTime).toJSON();
//                     var date = new Date(+new Date(dateee)+8*3600*1000).toISOString().replace(/T/g,' ').replace(/\.[\d]{3}Z/,'');
//                     return date;
//                 }
//
//             },
//             {field: 'adg', title: '操作', width: 240, toolbar: '#barDemo'}
//         ]]
//         ,page: true
//     });
//
//     //监听行工具事件
//     table.on('tool(test)', function(obj){
//         var data = obj.data;
//         //console.log(obj)
//         if(obj.event === 'del'){
//             layer.confirm('真的删除行么', function(index){
//                 $.ajax({
//                     url:  "/user/delete",
//                     type: "POST",
//                     data:{
//                         id:data.id
//                     },
//                     cache:false,
//                     dataType: "json",
//                     success: function(data){
//                         layer.msg(data.message);
//                         if(data.code=="0"){
//                             layer.close(index);
//                             setTimeout("javascript:location.href='/user'", 1500);
//                         }
//                     },
//                     error:function(err){
//                         layer.msg("服务器内部错误！")
//                     }
//                 });
//
//             });
//         } else if(obj.event === 'edit'){
//
//             window.location.href="/user/toEditUser?id="+ data.id
//         }
//     });
// });

window.operateEvents = {
    // 用户修改
    'click #edit': function (e, value, row, index) {
        window.location.href = ctxPath+"user/toEditUser?id="+row.id
    },
    // 用户删除
    'click #del': function (e, value, row, index) {
        $.ajax({
            url:  "/user/delete",
            type: "POST",
            data:{
                id:row.id
            },
            cache:false,
            dataType: "json",
            success: function(data){
                alert(data.message);
                if(data.code=="0"){
                    //layer.close(index);
                    setTimeout("javascript:location.href='/user'", 1500);
                }
            },
            error:function(err){
                layer.msg("服务器内部错误！")
            }
        });
    }
};

function addFunctionAlty(value, row, index) {
    return [
        '<button id="edit" type="button" class="btn bg-bold table-btn">编辑</button>',
        '<button id="del" type="button" class="btn bg-bold table-btn">删除</button>'
    ].join('');
}

$('#test').bootstrapTable({
    url: ctxPath+'user/getPage',
    method: 'GET',
    uniqueId: 'id',                        // 绑定ID，不显示
    striped: false,                         //是否显示行间隔色
    cache: false,                          //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
    sortable: true,                        //是否启用排序
    sidePagination: "server",              //分页方式：client客户端分页，server服务端分页（*）
    undefinedText: '--',
    strictSearch: true,
    clickToSelect: true,                   // 点击选中行
    pagination: true,                      //是否显示分页
    pageNumber:1,                          //初始化加载第一页，默认第一页,并记录
    pageSize:10,//每页显示的数量
    pageList: [ 10, 20, 50, 100],//设置每页显示的数量
    paginationPreText:"上一页",
    paginationNextText:"下一页",
    paginationLoop:false,
    //得到查询的参数
    queryParams : function (params) {
        //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
        var temp = {
            limit: params.limit,                         //页面大小
            page: (params.offset / params.limit) + 1,   //页码
            sort: params.sort,      //排序列名
            sortOrder: params.order //排位命令（desc，asc）
        };
        return temp;
    },
    columns:
        [{checkbox: true,width: 50}
            ,{field:'id',title: 'ID', }
            ,{field:'name',title: '姓名', }
            ,{field:'username', title: '账号'}
            ,{field:'orgName', title: '机构'}
            ,{field:'email', title: '邮箱'}
            ,{field:'isQuit', title: '是否离职'}
            ,{field:'createTime', title: '创建时间', }
            ,{field:'barcode', title: '操作',events: operateEvents,formatter: addFunctionAlty, }//表格中增加按钮
        ]
});

//           {type: 'checkbox'},
//             {field: 'id', title: 'ID',}
//             , {field: 'name', title: '姓名'}
//             , {field: 'username', title: '账号',}
//             , {field: 'orgName', title: '机构'}
//             , {field: 'email', title: '邮箱'}
//             , {field: 'isQuit', title: '是否离职',templet: function(d){
//                     var isQ=d.isQuit;
//                     if(isQ==0){
//                         return "在职";
//                     }else{
//                         return "离职"
//                     }
//                 }}
//             , {field: 'createTime', title: '创建时间' ,templet: function(d){
//                     var dateee = new Date(d.createTime).toJSON();
//                     var date = new Date(+new Date(dateee)+8*3600*1000).toISOString().replace(/T/g,' ').replace(/\.[\d]{3}Z/,'');
//                     return date;
//                 }
//
//             },
//             {field: 'adg', title: '操作', width: 240, toolbar: '#barDemo'}